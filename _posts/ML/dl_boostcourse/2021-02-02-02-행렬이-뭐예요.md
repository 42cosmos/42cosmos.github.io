---
layout: post
categories: Linear_Algebra
title: 행렬이 뭐예요
tags: vector
---

## 행렬

### 행렬을 이해하는 방법 (1)

- 벡터가 공간에서의 한 점이라면 행렬은 여러 점을 나타낸다
- 행렬의 행벡터 $x_i$ 는 i번째 데이터를 의미한다.



#### 덧셈, 뺄셈, 성분곱, 스칼라곱

- 행렬끼리 같은 모양을 가지면 덧셈, 뺄셈을 계산할 수 있다. (벡터의 덧뺄셈과 동일)
- 성분곱도 벡터와 동일하다. ( 각 성분의 동일 위치끼리의 곱 )



#### 행렬 곱셈 Matrix Multiplication

**i번째 행벡터와 j번째 열벡터** 사이 내적을 성분으로 가지는 행렬을 계산한다. 단 x의 열의 개수와 y의 행의 개수가 같아야 한다. ( 행렬 순서가 중요함 )





#### 행렬의 내적

- 넘파이 `np.inner` 는 두 행렬의 i, j번째 행벡터 사이의 내적을 성분으로 갖는 행렬을 계산한다. ( 두 행렬의 행 크기가 같아야 한다 )
- 행렬x와 y의 전치행렬을 행렬곱을 하면 `np.inner` 와 같은 결과를 보인다.



### 행렬을 이해하는 방법 (2)

- 벡터공간에서 사용되는 연산자로 이해한다 - Operator
- 행렬곱을 통해 벡터를 다른 차원 공간으로 보낼 수 있다
- 행렬곱을 통해 패턴을 추출하거나 데이터를 압축할 수 있다.
  - Linear Transform



### 역행렬 Inverse Matrix

- 행렬 A의 연산을 거꾸로 되돌리는 행렬
- **행과 열의 수가 같고, 행렬식(determinant)이 0이 아닌 경우에만 계산할 수 있다**
  - 역행렬 계산이 가능한지 먼저 확인해야 한다
- 행렬곱은 역행렬일 때 순서에 구애받지 않는다. 
- 항등행렬은 임의의 벡터나 행렬을 곱해주었을 때 자기자신이 나오게 된다.

![image-20210201234942690](/Users/eunbinpark/Library/Application Support/typora-user-images/image-20210201234942690.png)



- 역행렬 계산이 불가하다면, 유사역행렬 pseudo-inverse 또는 무어-펜로즈 Moore-Penrose 역행렬을 이용한다
  - 행과 열의 수가 달라도 계산이 가능
  - $A^{+}$로 표현한다.
  - 행과 열 중 어떤 개수가 많은지에 따라 계산 식이 달라진다.
    - 행이 열보다 많아지면, 유사역행렬은 원래 행렬보다 더 먼저 곱해주어야 항등행렬이 나온다
    - ![image-20210201235607577](/Users/eunbinpark/Library/Application Support/typora-user-images/image-20210201235607577.png)

#### 응용 1 : 연립방정식 풀기

`np.linalg.pinv` 를 이용하면 연립방정식의 해를 구할 수 있다.  ($a_{ij}$와 $b_{i}가 주어진 상황에서, 방정식을 만족하는 $x_j$를 구한다)

![image-20210202000109354](/Users/eunbinpark/Library/Application Support/typora-user-images/image-20210202000109354.png)



#### 응용 2 : 선형회귀분석

- n >= m, 변수 개수보다 데이터의 개수가 같거나 많을 때 선형 모델로 해석하는 선형회귀식을 찾는다
- 선형회귀분석은 연립방정식과 달리 행이 더 크므로 방정식을 푸는 것은 (x를 찾는 것) 불가능

사용되는 선형모델식 $\hat{y}$을 표현하고, $\hat{y}$과 데이터에서 주어져있는 라벨 Y벡터 차이가 최소화되는 것 > 적절한 모델

$L_2$노름을 이용했을 때 가장 근접하는 $\hat{y}$을 찾을 수 있다. 

x행렬의 무어펜로즈 역행렬을 y에 곱해주게 되면, 이때찾는 벡터가 최적의 선형회귀계수가 된다.



`sklearn` 의 `LinearRegression`은 자동으로 y절편을 자동추정해주지만, 무어펜로즈 역행렬은 y절편항을 직접 추가해 넣어주어야 한다.