I"¥$<h3 id="news-categorisitaion">News Categorisitaion</h3>

<p>ìˆ«ìë¥¼ ë²¡í„°ë¡œ ì¢Œí‘œí‰ë©´ìƒì— ì˜¬ë¦´ ìˆ˜ ìˆë„ë¡ ë°”ê¾¸ì–´ì£¼ì–´ì•¼ í•¨.</p>

<p>íŒŒì´ì¬ìœ¼ë¡œ ì–˜ê¸°í•˜ë©´ lmn ì´ ë§ì€ ë²¡í„°ë¥¼ ë§Œë“¤ê³  ë²¡í„°ë¼ë¦¬ì˜ ê±°ë¦¬ë¥¼ ë§Œë“¤ë©´ ë¨.</p>

<p>ë¬¸ì &gt; ìˆ«ì &gt; Vector</p>

<p>One hot Encoding (Bag of Words) ê¸°ë³¸ì  ë¬¸ì„œì— ëŒ€í•œ ë²¡í„° í‘œí˜„</p>

<p>í•˜ë‚˜ì˜ ë‹¨ì–´ë¥¼ ë²¡í„°ë¡œ ì¸ì‹í•˜ê¸° ìœ„í•´ì„œëŠ” ë²¡í„° ìŠ¤í˜ì´ìŠ¤ë¥¼ ë§Œë“¦</p>

<p>ë²¡í„° ìŠ¤í˜ì´ìŠ¤ : ê° ê¸€ìë“¤ì´ ì–´ë–¤ ì¸ë±ìŠ¤ì— í¬í•¨ë˜ëŠ”ì§€ ì •ì˜í•œ ê³µê°„
ë‹¨ì–´ë³„ë¡œ ì¸ë±ìŠ¤ë¥¼ ë¶€ì—¬í•´ ë¬¸ì¥ì— ë‹¨ì–´ê°€ ëª‡ ê°œì¸ì§€ í‘œí˜„</p>

<p><br /></p>

<h3 id="ìœ ì‚¬ì„±-íŒë³„">ìœ ì‚¬ì„± íŒë³„</h3>

<h5 id="euclidian-distance">Euclidian distance</h5>

<p>í”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬, ë‘ ì  ì‚¬ì´ì˜ ì§ì„  ê±°ë¦¬</p>

<h5 id="cosine-distance">cosine distance</h5>

<p>ë‘ ì  ì‚¬ì´ì˜ ê°ë„, ë°ì´í„°ì…‹ì´ í´ ìˆ˜ë¡ ì˜ ë‚˜ì˜¤ëŠ” ê²½í–¥ ì¡´ì¬</p>

<p>ë” ë§ì´ ì‚¬ìš©ë¨</p>

<p><br /></p>

<p>íŒŒì´ì¬ í´ë”ë¼ë¦¬ ì—°ê²° :</p>

<p>os.path.join &gt; ìœˆë„ìš°ì¦ˆëŠ” ì—­ìŠ¬ë˜ì‰¬, ë¦¬ëˆ…ìŠ¤ë‚˜ ë§¥ì€ ìŠ¬ë˜ì‰¬ë¼ì„œ â€¦ ì˜¤ì—ìŠ¤ì— ë§ì¶”ì–´ ì¡°ì¸ì„ í•´ì¤Œ</p>

<p>os.sep &gt; osì— ë”°ë¥¸ êµ¬ë¶„ ê¸°í˜¸ (\, /)</p>

<p><br /></p>

<p>corpus = í…ìŠ¤íŠ¸ ì›Œë“œë¡œ ì¸ë±ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì¤Œ / ë¬¸ì„œì˜ ìˆ˜ * ë‹¨ì–´ì˜ ìˆ˜ = ì´ ë§¤íŠ¸ë¦­ìŠ¤ì˜ í¬ê¸°</p>

<p>í•˜ë‚˜ì˜ ë¬¸ì„œì— ëŒ€í•œ ë²¡í„°ê°’ ë‹¨ì–´ ìˆ˜ì™€ ê°™ìŒ.</p>

<p>47ë¼ì¸ : í…ìŠ¤íŠ¸ì—ì„œ ë‹¨ì–´ë¥¼ ë½‘ê³ , ë‹¨ì–´ë¥¼ ì „ì²˜ë¦¬ì™€ ë˜‘ê°™ì€ ë°©ì‹ìœ¼ë¡œ get_cleaned_textí•¨ìˆ˜ë¥¼ ì ìš© : corpus ë”•íŠ¸ ì•ˆì— í‚¤ê°’ì„ ì‚¬ìš©í•´ ì´ ê°’ì˜ ì¸ë±ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒ == ì „ì²˜ë¦¬ ë°©ì‹ì´ ë™ì¼í•´ì•¼ í•¨. &gt; corpus[get_cleaned_text(word)] turned to number // ê²°ê³¼ê°’ : 3509 - ì²« ë²ˆì§¸ ë¬¸ì„œì˜ ì²« ë²ˆì§¸ ë‹¨ì–´ê°€ corpus dict ì— ìˆëŠ” 3509 ì¸ë±ìŠ¤ ê°’ì˜ ë¬¸ìë¼ëŠ” ëœ»</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">word_number_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">corpus</span><span class="p">[</span><span class="n">get_cleaned_text</span><span class="p">(</span><span class="n">word</span><span class="p">)]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span> <span class="k">for</span> <span class="n">words</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</code></pre></div></div>

<p><br /></p>

<p>48ë¼ì¸ : ë§¤íŠ¸ë¦­ìŠ¤ ìƒì„±.</p>

<p>[[0 for _ in range(len(corpus))] for x in range(len(text))]</p>

<p>0ì„ textì˜ ê¸¸ì´ (=80)ì— corpusì˜ ê¸¸ì´ (4032)ë§Œí¼ 2ì°¨ì› ë°°ì—´ë¡œ ìƒì„±</p>

<p>forì˜ _(ì–¸ë”ë°”) &gt; ì‚¬ìš©í•˜ì§€ ì•Šê² ë‹¤ëŠ” ì˜ë¯¸</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_vector</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corpus</span><span class="p">))]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))]</span>
</code></pre></div></div>

<p><br /></p>

<p><em>*50 ~ 53 line ì´í›„ ë¯¸ë¦¬ ë§Œë“¤ì—ˆë˜ word number list (</em>3509,,, ë“±ë“±)ì—ì„œ ê°ê°ì˜ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ì„ 1ì”© ì˜¬ë ¤ì£¼ë©´ ë¨ **</p>

<pre><code class="language-Python">    for i, text in enumerate(word_number_list):
        for word_number in text:
            X_vector[i][word_number] += 1
    return X_vector
</code></pre>

<p>ì „ì²´ corpus ì¸ë±ìŠ¤ ë²ˆí˜¸ ë³„ë¡œ ì–´ë–¤ ë‹¨ì–´ê°€ ëª‡ ê°œ ìˆëŠ”ì§€ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ í™•ì¸ ê°€ëŠ¥</p>

<p><br /></p>

<h4 id="ë¹„êµë°©ë²•">ë¹„êµë°©ë²•</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">math</span>
<span class="k">def</span> <span class="nf">get_cosine_similarity</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">):</span>
    <span class="s">"compute cosine similarity of v1 to v2: (v1 dot v2)/{||v1||*||v2||)"</span>
    <span class="n">sumxx</span><span class="p">,</span> <span class="n">sumxy</span><span class="p">,</span> <span class="n">sumyy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v1</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">y</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">sumxx</span> <span class="o">+=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
        <span class="n">sumyy</span> <span class="o">+=</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>
        <span class="n">sumxy</span> <span class="o">+=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>
    <span class="k">return</span> <span class="n">sumxy</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sumxx</span><span class="o">*</span><span class="n">sumyy</span><span class="p">)</span>
</code></pre></div></div>

<p>ì²« ë²ˆì§¸ ë¬¸ì„œì™€ ë‘ ë²ˆì§¸ ë¬¸ì„œì˜ ìœ ì‚¬ë„ë¥¼ ë³´ì—¬ì¤Œ</p>

<p><br /></p>

<h4 id="ë¹„êµ-ê²°ê³¼">ë¹„êµ ê²°ê³¼</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_similarity_score</span><span class="p">(</span><span class="n">X_vector</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
    <span class="n">source_vector</span> <span class="o">=</span> <span class="n">X_vector</span><span class="p">[</span><span class="n">source</span><span class="p">]</span>
    <span class="n">similarity_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">target_vector</span> <span class="ow">in</span> <span class="n">X_vector</span><span class="p">:</span>
        <span class="n">similarity_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">get_cosine_similarity</span><span class="p">(</span><span class="n">source_vector</span><span class="p">,</span> <span class="n">target_vector</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">similarity_list</span>


<span class="k">def</span> <span class="nf">get_top_n_similarity_news</span><span class="p">(</span><span class="n">similarity_score</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">operator</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">similarity_score</span><span class="p">)}</span>
    <span class="n">sorted_x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">sorted_x</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<p>source : ì°¾ê³ ì í•˜ëŠ” ë¬¸ì„œ</p>

<p>similarity_score : 80ê°œì˜ ë¬¸ì„œë“¤ì´ ë¹„êµ ëŒ€ìƒ ë¬¸ì„œì™€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ ê°’ì´ ì €ì¥ë¨. (0.6441510â€¦ )</p>

<p>similarity_list : 1 ê°œì˜ ë¬¸ì„œì™€ 80ê°œì˜ ë¬¸ì„œë¥¼ ë¹„êµí•œ í›„ì— ì €ì¥ë˜ì—ˆìŒ</p>

<p>ê° ë¬¸ì„œ ë²ˆí˜¸ë“¤ë§ˆë‹¤ ì–¼ë§ˆë‚˜ ê·¼ì ‘í•œì§€ ê°’ì„ ë³´ì—¬ì¤„ ê²ƒì„.</p>

<p><br /><strong>get_top_n_similarity_news</strong>  : í‚¤ê°’ìœ¼ë¡œ ì •ë ¬í•´ì„œ ë°¸ë¥˜ê°’ ì¤‘ ê°€ì¥ í° ê°’ì˜ ì¸ë±ìŠ¤ ê°’ì„ ê°™ì´ ë°˜í™˜í•´ì£¼ëŠ” í•¨ / ê°€ì¥ ìœ ì‚¬í•œ ê°’ 10ê°œ</p>
:ET