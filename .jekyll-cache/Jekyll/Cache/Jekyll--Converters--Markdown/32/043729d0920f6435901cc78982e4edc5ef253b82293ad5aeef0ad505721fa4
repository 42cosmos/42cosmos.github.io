I"–:<h3 id="ì›¹-í¬ë¡¤ëŸ¬-scrapy">ì›¹ í¬ë¡¤ëŸ¬ Scrapy</h3>

<ul>
  <li>íŒŒì´í”„ë¼ì¸ ì§€ì› : ë°ì´í„° í›„ì²˜ë¦¬ (í•„í„°ë§ ë“±) ê°€ëŠ¥</li>
  <li>ë¡œê¹… ì •ë³´ í™•ì¸ ê°€ëŠ¥</li>
  <li>ìƒëŒ€ì ìœ¼ë¡œ bsë³´ë‹¤ ê°„í¸í•¨</li>
  <li>ì•ˆì •ì  í¬ë¡¤ë§ ê°€ëŠ¥</li>
  <li>ì‹œê°„ ë‹¨ì¶• &gt; ë™ì‹œë‹¤ë°œì  í¬ë¡¤ë§ìœ¼ë¡œ ì¸í•œ ìˆœì„œ ë³€ê²½</li>
  <li>ë‹¤ì–‘í•œ í¬ë§·ìœ¼ë¡œ ì €ì¥ ê°€ëŠ¥</li>
</ul>

<p>Framework</p>

<ul>
  <li>í•¨ìˆ˜ì™€ ì½”ë“œ ì„ ì‘ì„±</li>
  <li>íŠ¹ì„± í•¨ìˆ˜ì˜ ìœ„ì¹˜, ì‚¬ìš©, ì‘ì„±ì„ ì§€ì •</li>
  <li></li>
</ul>

<h4 id="beautiful-soup">Beautiful Soup</h4>

<ul>
  <li>parserì˜ ì—­í• ì´ ê°•í•¨</li>
  <li>ìë™ìœ¼ë¡œ ìœ ë‹ˆì½”ë“œë¡œ ë³€í™˜í•´ì„œ UTF-8 ì¶œë ¥</li>
</ul>

<p>###</p>

<h4 id="spider">Spider</h4>

<ol>
  <li>ì´ë¦„ : ì—¬ëŸ¬ ê°€ì§€ í¬ë¡¤ëŸ¬(spider)ë¥¼ ë‘˜ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ê° ì´ë¦„ì„ ì§€ì •</li>
  <li>í˜ì´ì§€ ì£¼ì†Œ : í¬ë¡¤ë§ í•  ì£¼ì†Œ ì§€ì •</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scrapy genspider 'crawler_name' 'url'

# Expected Result
Created spider 'gmarket' using template 'basic' in module:
  ecommerce.spiders.gmarket
</code></pre></div></div>

<p><img src="/images/scrapy_tutorial_list.png" alt="scrapy_tutorial_list" /></p>

<ol>
  <li>items.py - ë°ì´í„°ë¥¼ ë“¤ê³ ì˜¬ ë•Œ í´ë˜ìŠ¤ í˜•íƒœë¡œ ë§Œë“¤ ìˆ˜ ìˆìŒ</li>
  <li>pipelines.py - ë°ì´í„° ìˆ˜ì§‘ í›„ í›„ì²˜ë¦¬ í•„í„°ë§ ì…ë ¥ ì§„í–‰</li>
  <li>settings.py - ìŠ¤í¬ë˜í”¼, ìŠ¤íŒŒì´ë” ì„¤ì • : íŒŒì´í”„ë¼ì¸ ìˆœì„œ, ì´ë¦„ ë“±ì˜ ì„¤ì •</li>
  <li>spider/ - ìŠ¤í¬ë© í•  ë‚´ìš©ì„ í”„ë¡œê·¸ë˜ë°</li>
</ol>

<h4 id="itemspy">items.py</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">scrapy</span>

<span class="k">class</span> <span class="nc">TutorialItem</span><span class="p">(</span><span class="n">scrapy</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span> <span class="c1"># ìƒì† í•„ìˆ˜
</span>    <span class="n">title</span> <span class="o">=</span> <span class="n">scrapy</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">scrapy</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">scrapy</span><span class="o">.</span><span class="n">Field</span><span class="p">()</span>
</code></pre></div></div>

<p>ê°€ì ¸ì˜¤ë ¤ëŠ” ì•„ì´í…œ ì •ì˜</p>

<h4 id="spidernew_filepy">/spider/new_file.py</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">scrapy</span>

<span class="k">class</span> <span class="nc">linkScrap</span><span class="p">(</span><span class="n">scrapy</span><span class="o">.</span><span class="n">Spider</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"dmoz"</span> <span class="c1"># ìŠ¤íŒŒì´ë” ì´ë¦„ ì§€ì •
</span>    <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="s">"dmoztools.net"</span><span class="p">]</span>
    <span class="n">start_urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'https://dmoztools.net/Computers/Programming/Languages/Python/Books/'</span><span class="p">,</span>
    <span class="s">'https://dmoztools.net/Computers/Programming/Languages/Python/Resources/'</span>
    <span class="p">]</span> <span class="c1"># ìŠ¤í¬ë© í•  url ì§€ì •
</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'//div'</span><span class="p">):</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'div[3]/a/div/text()'</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'div[3]/a/@href'</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
            <span class="n">desc</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'/div[3]/div/text()'</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"*"</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">i.xpath('/div[3]/div/text()').extract() </code> ì˜ ê°’ì€</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['\r\n\t\t\t\r\n                                    The primary goal of this book is to promote object-oriented design using Python and to illustrate the use of the emerging object-oriented design patterns.\r\nA secondary goal of the book is to present mathematical tools just in time. Analysis techniques and proofs are presented as needed and in the proper context.\r\n                                    ',
 '\r\n                                  ',
 '\r\n                                  ',
 '\r\n                                ',
 '\r\n                                  ',
 '\r\n                                  ',
 '\r\n                                ',
 'Health']
</code></pre></div></div>

<p>ë¡œ ë‚˜ì˜¤ë‹ˆ ë¦¬ìŠ¤íŠ¸ 0ë²ˆì§¸ ê°’ ì¶”ì¶œ í›„ strip()ìœ¼ë¡œ ë‚´ìš©ë§Œ ì¶”ì¶œâ€¦ í•˜ê³ ì‹¶ì—ˆëŠ”ë° ë¹ˆì¹¸ì´ ì¶œë ¥ë¨</p>

<h4 id="in-terminal---shell">in Terminal - shell</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">scrapy</span> <span class="n">shell</span> <span class="s">'url'</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">response</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'//title'</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>                                     
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">[</span><span class="s">'&lt;title&gt;DMOZ - Computers: Programming: Languages: Python: Books&lt;/title&gt;'</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">response</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'//title'</span><span class="p">)</span>                                               
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Selector</span> <span class="n">xpath</span><span class="o">=</span><span class="s">'//title'</span> <span class="n">data</span><span class="o">=</span><span class="s">'&lt;title&gt;DMOZ - Computers: Programming:...'</span><span class="o">&gt;</span><span class="p">]</span>
  
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">response</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'//title/text()'</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>                              
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="p">[</span><span class="s">'DMOZ - Computers: Programming: Languages: Python: Books'</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">response</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">'//title/text()'</span><span class="p">)</span><span class="o">.</span><span class="n">re</span><span class="p">(</span><span class="s">'(</span><span class="err">\</span><span class="s">w+):'</span><span class="p">)</span>                          
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="p">[</span><span class="s">'Computers'</span><span class="p">,</span> <span class="s">'Programming'</span><span class="p">,</span> <span class="s">'Languages'</span><span class="p">,</span> <span class="s">'Python'</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="ë¬¸ë²•---ì‚¬ìš©ë²•">ë¬¸ë²• - ì‚¬ìš©ë²•</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>response.css('head &gt; title').get() 
response.css('head &gt; title').getall() # list
response.css('head &gt; title::text').get() # 
response.xpath('//div/ul/li/text()').get() # 
response.css('div.best-list li &gt; a::text').getall(
</code></pre></div></div>

<h4 id="ì •ê·œí‘œí˜„ì‹">ì •ê·œí‘œí˜„ì‹</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>response.css('div.best-list li &gt; a::text')[1].re('(\w+)')

response.xpath('//div[@class="best-list"]/ul/li/a/text()')[1].re('(\w+)')
</code></pre></div></div>

<h3 id="pipelines---filtering">Pipelines - Filtering</h3>

<p>ì•„ì´í…œì´ ìƒì„±ë  ë•Œ íŒŒì´í”„ë¼ì¸ í•¨ìˆ˜ë¥¼ í•œ ë²ˆì”© ê±°ì¹œë‹¤ê³  ìƒê°€í•˜ë©´ ë¨!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scrapy.exceptions</span> <span class="kn">import</span> <span class="n">DropItem</span>
<span class="k">class</span> <span class="nc">NavernewsPipeline</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">process_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">spider</span><span class="p">):</span>
<span class="k">print</span> <span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s">'price'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
<span class="k">return</span> <span class="n">item</span> <span class="k">else</span><span class="p">:</span>
<span class="k">raise</span> <span class="n">DropItem</span><span class="p">(</span><span class="s">"drop item having lower price than 10000"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="dd">dd</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">start_requests</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">scrapy</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s">'http://corners.gmarket.co.kr/Bestsellers'</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">)</span>

</code></pre></div></div>

<p>ì§€ì • url í¬ë¡¤ë§ í›„ parse í•¨ìˆ˜ë¥¼ call-back ( call-back ìœ¼ë¡œ ë¶€ë¥´ëŠ” í•¨ìˆ˜ëŠ” ë°˜ë“œì‹œ response ë³´ìœ  í•„ìˆ˜)</p>

<h3 id="ë¬¸ì œ">ë¬¸ì œ</h3>

<ol>
  <li>
    <p>describtionì´ ì „í˜€ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤.</p>

    <p><code class="highlighter-rouge">scrapy shell url</code> ë¡œ ë§Œì§ˆ ë•ŒëŠ” ì•„ì£¼ ì˜ ë‚˜ì˜¤ëŠ”ë° ë§‰ìƒ ì½”ë“œë¡œ ë„£ìœ¼ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë§Œ ë°˜í™˜í•œë‹¤.  ë¯¸ì¹˜ê² ë‹¤â€¦ ë¯¸ì¹˜ê² ë‹¤ ì™¸ â€¦ ì•Šë˜? ì™œ ì•ˆ ë˜ëŠ”ì§€ ì •ë§ ëª¨ë¥´ê² ë‹¤â€¦ ì§ì‘ì€ ê°€ëŠ”ë°â€¦ ë‚´ê°€ ì–´ë–»ê²Œ ë§Œì ¸ì•¼í•˜ëŠ”ì§€ ëª¨ë¥´ê² ë‹¤â€¦ ë¹µ ë¨¹ê³ ì‹¶ë‹¤â€¦</p>

    <p>title:</p>

    <p>//*[@id=â€site-list-contentâ€]/div[17]/div[3]/a/div</p>

    <p>//*[@id=â€site-list-contentâ€]/div[18]/div[3]/a/div</p>

    <p>desc:</p>

    <p>//*[@id=â€site-list-contentâ€]/div[17]/div[3]/div/text()</p>

    <p>//*[@id=â€site-list-contentâ€]/div[18]/div[3]/div/text()</p>
  </li>
  <li>
    <p>ì“°ë ˆê¸°ê°’ í•´ê²° ë¬¸ì œ</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"title": ["Data Structures and Algorithms with Object-Oriented Design Patterns in Python "], "link": ["http://www.brpreiss.com/books/opus7/html/book.html"], "desc": ["\r\n\t\t\t\r\n                                    The primary goal of this book is to promote object-oriented design using Python and to illustrate the use of the emerging object-oriented design patterns.\r\nA secondary goal of the book is to present mathematical tools just in time. Analysis techniques and proofs are presented as needed and in the proper context.\r\n                                    ", "\r\n                                  "]},
{"title": [], "link": [], "desc": []},
   
</code></pre></div>    </div>

    <ol>
      <li>ê°’ì´ ì •í™•íˆ ë‚˜ì˜¨ ë¶€ë¶„ì˜ ë¬¸ì œ : desc ë¦¬ìŠ¤íŠ¸ [0]ë²ˆì§¸ ê°’ë§Œ í•„ìš”í•¨ - ì •ê·œí‘œí˜„ì‹ì„ ì¨ì•¼ í•˜ëŠ” ê±´ê°€? ê·¼ë° ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¼ì„œ stripë§Œ ë˜ëŠ” ê±° ê°™ì€ë°â€¦</li>
      <li>ë¹ˆ ê°’ ì²˜ë¦¬ - ë­ì•¼!</li>
    </ol>

    <p>ë¥¼ í•´ì•¼í•œë‹¤â€¦</p>
  </li>
</ol>

<h3 id="ë¬¸ì œ-í•´ê²°">ë¬¸ì œ í•´ê²°</h3>

<ol>
  <li>
    <p><code class="highlighter-rouge">i.xpath('/div[3]/div/text()').extract()</code> &gt; <code class="highlighter-rouge">i.xpath('div[3]/div/text()').extract()</code></p>

    <p>í•˜~ ì§„ì§œ ìŠ¬ë˜ì‰¬ ë•Œë¬¸ì— ê°œê³ ìƒ í•˜ë‹¤ë‹ˆâ€¦í•³</p>
  </li>
</ol>

<h3 id="ê³ ì°°">ê³ ì°°</h3>

<ol>
  <li>ë‚˜ëŠ” ë°”ë³´ë‹¤</li>
  <li>ëˆˆì„ ë˜‘ë°”ë¡œ ëœ¨ì</li>
  <li>ë” ë˜‘ë˜‘í•´ì§€ì</li>
  <li>ì»´í“¨í„°ëŠ” ì˜ëª» ì—†ë‹¤</li>
</ol>

:ET